- present(@product) do |product|
  .container
    %h1
      = product.name
      - if product.reviews.any?
        .reviews__rating{ data: { score: product.average_rating } }
    .row
      .col-xs-12.col-md-4
        = image_tag(product.image_url, class: 'img-responsive', alt: '')
        %p.product__price-tag
          = product.formatted_price
        %p
          %strong Colour
          %br
          = product.colour
        %p
          = link_to 'Back', products_path, class: 'btn btn-default'
          - if authorize @product, :edit?
            = link_to 'Edit', edit_product_path(product), class: 'btn btn-default'
          - if authorize @product, :destroy?
            = link_to 'Delete', product_path(product), class: 'btn btn-danger', method: :delete, data: { confirm: 'Are you sure?' }
      .col-xs-12.col-md-8
        .product_checkout
          - if signed_in?
            = form_with url: payments_url do |f|
              = f.hidden_field :product_id, value: product.id
              = render 'shared/stripe_checkout_button', product: product, user: current_user
          - else
            = link_to 'Pay with Card', sign_in_path, class: 'btn btn-primary'
        .product__description
          = product.description

          %hr
          .product__reviews
            %h3 What our customers say
            - if @reviews.any?
              = render partial: 'reviews/review', collection: @reviews, locals: { reviewable: product }

              = link_to 'Show all reviews', product_reviews_path(product)
            - else
              There are no reviews yet.

          - if signed_in?
            %hr
            %h4 Submit a review
            = form_for [product, @review] do |f|
              .form-group
                = f.label :comment
                = f.text_area :comment, rows: 6, class: 'form-control'

              .form-group
                = f.label :rating
                .rating

              = f.submit 'Create a review', class: 'btn btn-primary'
